# Build @PACKAGE_STRING@
#
# @configure_input@
#
# C++ encapsulation of ATMI and a set of tools to help write Tuxedo applications.

prefix=@prefix@
exec_prefix=@exec_prefix@
LIBDIR=@libdir@
INCLUDEDIR=@includedir@/atmi

INSTALL=@INSTALL@ 
LOCALEDIR=@localedir@
LIBDIR=@libdir@

RM=@RM@
DOXYGEN=@DOXYGEN@
CODECHECK=@CODECHECK@
MKDIR=@MKDIR_P@

PACKAGE_DEVELOP=@PACKAGE_NAME@-@PACKAGE_VERSION@-@build_os@-dev.tar.gz
PACKAGE=@PACKAGE_NAME@-@PACKAGE_VERSION@-@build_os@.tar.gz

HEADERS=@HEADERS@
LIBS=libatmi++.a libcltatmi++.a libfml++.a
BINS=tmreboot

all:
	(cd src && $(MAKE) all )
	(cd utls && $(MAKE) all )

#demos:
#	cd samples/atmi++ ; $(MAKE) globber all clean
#	cd samples/utl ; $(MAKE) globber all clean

pkg:
	$(MKDIR) distrib
	tar cf - `git ls-files`  | gzip -c > distrib/$(PACKAGE_DEVELOP)
	tar cf -  bin            | gzip -c > distrib/$(PACKAGE)

clean:
	( cd src && make clean )
	( cd utls && make clean )
	$(RM) -R distrib

globber:clean
	${RM} -R distrib doc html man autom4te.cache distrib
	${RM} confdefs.h config.status 
	(cd src && $(MAKE) globber)
	(cd utls && $(MAKE) globber)

doxygen:
	${DOXYGEN}

codecheck:
	$(CODECHECK)

version:
	touch configure.ac && autoconf
	cd src && touch configure.ac && autoconf
	cd utls && touch configure.ac && autoconf
	-echo "don't forget to run configure."

install: 
	$(MKDIR) $(INCLUDEDIR) && $(INSTALL) include/atmi/*.hpp include/atmi/*.h $(INCLUDEDIR)
	$(INSTALL) lib/*.a @libdir@
	$(INSTALL) bin/*   @bindir@

uninstall:
	$(RM) -R  $(INCLUDEDIR)
	(cd @libdir@ && $(RM) ${LIBS})
	(cd @bindir@ && $(RM) $(BINS))
